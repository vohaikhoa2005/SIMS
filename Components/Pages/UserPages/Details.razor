@page "/users/details"
@using Microsoft.AspNetCore.Identity
@using Microsoft.EntityFrameworkCore
@using SIMS.Data
@inject UserManager<ApplicationUser> UserManager
@inject NavigationManager NavigationManager

<PageTitle>User Details</PageTitle>

<div class="container-fluid p-4">
 <div class="d-flex align-items-center mb-4">
 <a href="/users" class="btn btn-outline-secondary me-3"><i class="bi bi-arrow-left"></i></a>
 <h1 class="mb-0"><i class="bi bi-info-circle text-primary"></i> User Details</h1>
 </div>

 @if (User is null)
 {
 <div class="card shadow-sm"><div class="card-body">Loading...</div></div>
 }
 else
 {
 <div class="card shadow-sm"><div class="card-body">
 <dl class="row">
 <dt class="col-sm-3">Email</dt><dd class="col-sm-9">@User.Email</dd>
 <dt class="col-sm-3">Name</dt><dd class="col-sm-9">@User.Name</dd>
 <dt class="col-sm-3">Code</dt><dd class="col-sm-9">@User.Code</dd>
 <dt class="col-sm-3">Roles</dt><dd class="col-sm-9">@RolesStr</dd>
 </dl>
 <a class="btn btn-outline-secondary" href="/users">Back to List</a>
 </div></div>
 }
</div>

@code {
 [SupplyParameterFromQuery]
 public string Id { get; set; } = "";
 private ApplicationUser? User { get; set; }
 private string RolesStr { get; set; } = "";
 protected override async Task OnInitializedAsync()
 {
 if (!string.IsNullOrEmpty(Id))
 {
 User = await UserManager.FindByIdAsync(Id);
 if (User is null) { NavigationManager.NavigateTo("notfound"); return; }
 var roles = await UserManager.GetRolesAsync(User);
 RolesStr = string.Join(", ", roles);
 }
 }
}
